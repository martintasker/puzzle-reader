{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap bbd5e7b5174548d24501","webpack:///./src/puzzle-reader.js","webpack:///external \"marked\"","webpack:///external \"react\""],"names":["reader","mdString","htmlString","h1Sections","_geth1Sections","rubric","join","puzzleSections","_getPuzzleSections","puzzle","_extractPuns","puns","cleanParas","text","lines","split","output","outLabel","forEach","line","h1Label","rx","matches","match","push","puzzleHTML","html","sections","paraSections","map","section","filter","res","i","length","para","p","paras","spans","tag","pun","render","punElement","createElement","mapLine","key","mapSpan","span","index"],"mappings":"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","file":"puzzle-reader.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"marked\"), require(\"react\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"marked\", \"react\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"PuzzleReader\"] = factory(require(\"marked\"), require(\"react\"));\n\telse\n\t\troot[\"PuzzleReader\"] = factory(root[\"marked\"], root[\"react\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_2__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap bbd5e7b5174548d24501","import marked from 'marked';\nimport React from 'react';\n\nclass reader {\n  constructor(mdString) {\n    this.mdString = mdString;\n    const htmlString = marked(mdString);\n    const h1Sections = this._geth1Sections(htmlString);\n    this.rubric = h1Sections.rubric.join('');\n    const puzzleSections = this._getPuzzleSections(h1Sections.puzzle);\n    const {puns, cleanParas} = this._extractPuns(puzzleSections);\n    this.puzzle = {puns, text: cleanParas};\n  };\n\n  _geth1Sections(htmlString) {\n    const lines = htmlString.split('\\n');\n    const output = {rubric: [], puzzle: []};\n    var outLabel = \"\";\n    lines.forEach(function(line) {\n      if (!line) {\n        return;\n      }\n      var h1Label = ((line) => {\n        const rx = /<h1 id=\\\"(.*)?\\\".*<\\/h1>/\n        const matches = line.match(rx);\n        if (!matches) {\n          return \"\";\n        }\n        return matches[1];\n      })(line);\n      if (h1Label) {\n        outLabel = h1Label;\n        output[outLabel] = output[outLabel] || [];\n        return;\n      }\n      if (outLabel) {\n        output[outLabel].push(line);\n      }\n    });\n    return output;\n  }\n\n  _getPuzzleSections(puzzleHTML) {\n    const html = puzzleHTML.join(' ');\n    const sections = html.split(/<h2.*?section<\\/h2>/);\n    const paraSections = sections.map(section => section.split(/<\\/?p>/).filter(line => line!==\"\" && line!==\" \"));\n    var res = [];\n    for (var i = 0; i<sections.length; ++i) {\n      if (i>0) {\n        res.push(\"br\");\n      }\n      paraSections[i].forEach(function(para) {\n        res.push({p: para});\n      });\n    }\n    return res;\n  }\n\n  _extractPuns(paras) {\n    const puns = [];\n    const cleanParas = paras.map(function(para) {\n      if (typeof para === 'string') {\n        return para;\n      }\n      const rx = /<strong>(.*?)<\\/strong>/g;\n      const text = para.p;\n      const matches = text.match(rx);\n      if (!matches) {\n        return {p: [text]};\n      }\n      var res = [];\n      const spans = text.split(/<strong>.*?<\\/strong>/);\n      for (var i=0; i<spans.length; i++) {\n        if (i > 0) {\n          puns.push((tag => tag.match(/<strong>(.*)<\\/strong>/)[1])(matches[i-1]));\n          res.push({pun: puns.length - 1});\n        }\n        if (!!spans[i]) {\n          res.push(spans[i]);\n        }\n      }\n      return {p: res};\n    });\n    return {puns, cleanParas};\n  }\n\n  getRubric() {\n    return this.rubric;\n  }\n\n  getPuzzle() {\n    return this.puzzle;\n  }\n}\n\nconst render = (puzzle, punElement) => {\n\n  return React.createElement('div', null, puzzle.text.map(mapLine));\n\n  function mapLine(line, i) {\n    if (typeof line === 'string') {\n      return React.createElement('br', {key: i});\n    }\n    var text = line.p;\n    if (!text) {\n      return null;\n    }\n    return React.createElement('p', {key: i}, text.map(mapSpan));\n  }\n\n  function mapSpan(span, i) {\n    if (typeof span === 'string') {\n      return React.createElement('span', {key: i}, [span]);\n    }\n    return React.createElement(punElement, {key: i, pun: puzzle.puns[span.pun], index: span.pun});\n  }\n}\n\nexport default {reader, render};\n\n\n\n// WEBPACK FOOTER //\n// ./src/puzzle-reader.js","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"marked\"\n// module id = 1\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react\"\n// module id = 2\n// module chunks = 0"],"sourceRoot":""}